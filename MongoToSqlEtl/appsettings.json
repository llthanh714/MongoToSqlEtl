{
  "ConnectionStrings": {
    "MongoDb": "mongodb://aapuchongit:__MONGOGDB_PASSWORD__@10.10.9.20:45431/?authSource=arcusairdb&directConnection=true&readPreference=secondaryPreferred",
    "SqlServer": "server=192.168.1.72;database=ArcusAir;uid=sa;pwd=__DB_PASSWORD__;TrustServerCertificate=True;",
    "Hangfire": "server=192.168.1.72;database=ArcusAir;uid=sa;pwd=__DB_PASSWORD__;TrustServerCertificate=True;"
  },
  "NotificationSettings": {
    "SlackWebhookUrl": "__SLACK_WEBHOOK__"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "Kestrel": {
    "EndpointDefaults": {
      "Protocols": "Http2"
    },
    "Certificate": {
      "Path": "C:\\certificates\\phuongchau.pfx",
      "Password": "__KESTREL_CERT_PASSWORD__"
    }
  },
  "RecurringJobs": [
    {
      "Name": "minutely-patientorders",
      "JobType": "MongoToSqlEtl.Jobs.PatientOrdersEtlJob, MongoToSqlEtl",
      "Cron": "0 1 * * *",
      "TimeZone": "Asia/Bangkok",
      "Enabled": true,
      "MaxRecordsPerJob": 500,
      "Backfill": {
        "Enabled": false
      }
    },

    // Đây là cấu hình cho referencevalues và không có bảng con nào
    {
      "Name": "daily-referencevalues",
      "JobType": "MongoToSqlEtl.Jobs.ConfigurableEtlJob, MongoToSqlEtl",
      "Cron": "0 1 * * *",
      "TimeZone": "Asia/Bangkok",
      "Enabled": true,
      "MaxRecordsPerJob": 3000,
      "Backfill": {
        "Enabled": false
      },
      "MergeStoredProcedure": null,
      "Mappings": [
        {
          "MongoFieldName": "referencevalues",
          "SqlTableName": "referencevalues",
          "ParentMongoFieldName": null,
          "ForeignKeyName": ""
        }
      ]
    },

    // Đây là cấu hình cho job ETL của bảng `orderitems` với các bảng con `orderitemcodes` và `orderiteminstructions`
    {
      "Name": "daily-orderitems",
      "JobType": "MongoToSqlEtl.Jobs.ConfigurableEtlJob, MongoToSqlEtl",
      "Cron": "0 1 * * *",
      "TimeZone": "Asia/Bangkok",
      "Enabled": true,
      "MaxRecordsPerJob": 1000,
      "Backfill": {
        "Enabled": false
      },
      "MergeStoredProcedure": null,
      "Mappings": [
        {
          "MongoFieldName": "orderitems",
          "SqlTableName": "orderitems",
          "ParentMongoFieldName": null,
          "ForeignKeyName": ""
        },
        {
          "MongoFieldName": "orderitemcodes",
          "SqlTableName": "orderitemcodes",
          "ParentMongoFieldName": "orderitems",
          "ForeignKeyName": "orderitemsuid",
          "ParentIdSourceField": "_id"
        },
        {
          "MongoFieldName": "orderiteminstructions",
          "SqlTableName": "orderiteminstructions",
          "ParentMongoFieldName": "orderitems",
          "ForeignKeyName": "orderitemsuid",
          "ParentIdSourceField": "_id"
        }
      ]
    },

    // Đây là cấu hình cho job ETL của bảng `patients` với các bảng con `patientsaddress` và `patientscontact`
    {
      "Name": "minutely-patients",
      "JobType": "MongoToSqlEtl.Jobs.ConfigurableEtlJob, MongoToSqlEtl",
      "Cron": "0 2 * * *", // Chạy vào 2h sáng
      "TimeZone": "Asia/Bangkok",
      "Enabled": true,
      "MaxRecordsPerJob": 1000,
      "Backfill": {
        "Enabled": false
      },
      "MergeStoredProcedure": null,
      "Mappings": [
        {
          // Bảng cha: patients
          "MongoFieldName": "patients", // Tên collection nguồn
          "SqlTableName": "patients",
          "ParentMongoFieldName": null, // Đây là gốc
          "ForeignKeyName": "" // Không có khóa ngoại
        },
        {
          // Bảng con 1: patientsaddress
          "MongoFieldName": "address", // Tên trường mảng trong document `patients`
          "SqlTableName": "patientsaddress",
          "ParentMongoFieldName": "patients", // Cha của nó là `patients`
          "ForeignKeyName": "patientsuid", // Tên khóa ngoại
          "ParentIdSourceField": "_id" // Lấy giá trị từ trường `_id` của cha
        },
        {
          // Bảng con 2: patientscontact
          "MongoFieldName": "contact", // Tên trường mảng
          "SqlTableName": "patientscontact",
          "ParentMongoFieldName": "patients", // Cha của nó là `patients`
          "ForeignKeyName": "patientsuid",
          "ParentIdSourceField": "_id"
        }
      ]
    }
  ]
}